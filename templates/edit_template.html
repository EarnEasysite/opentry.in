<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/cropperjs/dist/cropper.css" />
    <script src="https://unpkg.com/cropperjs/dist/cropper.js"></script>
    <link rel="icon" href="https://res.cloudinary.com/dkr5qwdjd/image/upload/v1726940057/Mythesis_images/qwbmpso8kb9dkr4bdhkm.png" type="image/x-icon">
    <title>Edit Template</title>
    <style>
body {
    font-family: Arial, sans-serif;
    background-color: #2a2a2a;
    color: #e0e0e0;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    overflow-x: hidden;
}

.video-container {
    display: flex; /* Enables flexbox for centering content */
    align-items: center; /* Centers items vertically */
    justify-content: center; /* Centers items horizontally */
    margin-top: 20px; /* Adds some top margin */
    text-align: center; /* Centers text (if needed) */margin-bottom: 90%;
}

video {
    
    
    height: 330px; /* Maintains aspect ratio */
    border: none; /* Removes any default border */
    border-radius: 20px; /* Rounds the corners */
}
.video-section {
    display: flex; /* Enables Flexbox layout */
    justify-content: center; /* Centers the video horizontally */
    align-items: center; /* Centers the video vertically */
     /* Optional: sets the height to the full viewport */
}

.footer {
  display: flex;
  justify-content: space-around;
  padding: 20px 0;
  background-color: #333;
  color: #fff;
}

.footer-item {
  display: flex;
  
  align-items: center;
}

.footer-item img {
  margin-right: 10px;
}

.footer-item p {
  font-size: 1.2em;
  margin: 0;
}
.upload-popup {
    position: fixed;
    top: 100%;   
    width: 100%;
    left: 0;
    margin-bottom: 40px;
    padding-bottom: 100%;
    bottom: 0;
    border: none;
    border-top-left-radius: 35px;
    border-top-right-radius: 35px;
    height: 60%;
    background-color:#2a2a2a;
    box-shadow: 0px -2px 10px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.upload-popup.active {
    top: 40%;
}

.popup-content {
    
    height: auto;
    text-align: center;
    
}

/* Close button styles */
.close-popup {
    position: absolute;
    top: 10px;
    right: 20px;
    background: none;
    border: none;
    font-size: 24px;
    font-weight: bold;
    color: #676767;
    cursor: pointer;
}

.close-popup:hover {
    color: #f00;
}

#submitImage {
    margin-top: 10px;
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
}

#submitImage:hover {
    background-color: #0056b3;
}
#imagePreview {
    position: relative;
     /* Full width inside the popup */
    max-height: 200px; 
    width: auto;/* Limit the max height of the preview area */
    object-fit: contain; /* Ensure the image scales properly without distortion */
    border: 2px solid #ddd; /* Light border around the preview area */
    margin-top: 20px;
    border-radius: 8px;
     /* Hide the image preview initially */
}

/* Cropper specific styles */
.cropper-container {
    width: 100%; /* Ensure the cropper takes the full width of its parent */
    height: 800px; /* Set a large height for better visibility and usability */
    max-height: 90vh; /* Ensure it doesn't exceed the viewport height */
    margin-top: 10px;
    border: 1px solid #ccc; /* Optional: add a border for clarity */
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1); /* Optional: subtle shadow for a more elevated look */
}


/* Style for the "Crop Image" button */
#cropImage {
    height: auto;
    background-color: #24a281; /* Green background */
    color: white; /* White text */
    padding: 10px 20px;
    margin-top: 20px;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
}

#cropImage:hover {
    background-color: #2b9476; /* Darker green on hover */
}

/* Disable cropping button while no image is selected */
#cropImage:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}
/* Header Styles */
.edit {
    display: flex;
    flex-direction: column;
    justify-content: space-between; /* Space between title and buttons */
    align-items: center;
    padding-bottom: 40px;
    margin-bottom: 5px;
    color: #fff;
    position: relative;
    width: 100%;
    height: 40px; /* Adjust height to accommodate both title and buttons */
}

/* Title Styling */
.editline {
    font-size: 16px;
    font-weight: bold;
    margin-top: 60px; /* No extra margin */
    color: #fff;
    text-align: center;
}

/* Bottom Button Container */
.header-bottom {
    display: flex;
    justify-content: space-between;
    width: 100%; /* Full width to align buttons properly */ /* Padding for button spacing */
    position: absolute;
    bottom: 0px; /* Adjust to place buttons at the bottom of the header */
}

/* Button Styles */
.header-button {
    display: flex;
    align-items: center;
    gap: 5px; /* Space between icon and text */
    padding: 5px;
    border: none;margin: 5px;
    margin-left: 25px;
    margin-right: 25px;
    background: #444; /* Button background color */
    color: #fff;
    border-radius: 100%;
    cursor: pointer;
    transition: background-color 0.3s ease;
    font-size: 12px;
}

/* SVG Icon Styles */
.header-button svg {
    stroke: #fff;
}

/* Hover Effect for Buttons */
.header-button:hover {
    background-color: rgba(255, 255, 255, 0.2); /* Hover effect */
}
/* Positioning the navigation bar on the left */
.nav {
  margin-left: 10px;
  position: absolute; /* Position it absolutely */
  left: 0; /* Align it to the left edge */
  top: 0; /* Align it to the top */
  width: 50px; /* Set a fixed width for the navigation */
  background: #d9d9d9; /* Light background color */
  border-right: 1px solid #ccc; /* Subtle border to separate from main content */
  box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1); /* Shadow for a subtle 3D effect */
  padding: 10px; /* Padding inside the navigation */
  height: 100vh; /* Full height of the viewport */
}

/* Styling for anchor tags inside list items */
li a {
  text-decoration: none;
  color: #2d2f31; /* Dark text color */
  font-family: Arial, sans-serif; /* Adjust font for readability */
}

/* Styling for interactive spans */
span {
  width: 70%;
  margin: 5px;
  padding: 5px; /* Consistent padding around the text */
  background:#444; /* Dark background for contrast */
  color: white; /* White text color */
  font-size: 0.8em; /* Font size adjustment */
  font-variant: small-caps; /* Small caps for an elegant look */
  cursor: pointer; /* Pointer cursor for clickability */
  display: block; /* Block display to span the full width */
  border-radius: 5px; /* Slight rounding of corners */
  transition: background-color 0.3s; /* Smooth transition on hover */
  margin-bottom: 0px; /* Space between spans */
}

/* Hover effect for span */
span:hover {
  background: #1f1f1f; /* Darker shade on hover */
}

/* Span with a plus sign */
span::after {
  float: right; /* Floats to the right inside the span */ /* Adjusts spacing from the right edge */
  content: "+"; /* Displays the plus sign */
  font-size: 1.2em; /* Matches font size of the span */
  color: #ffffff; /* White color to match the text */
}

/* Slide container for expandable content */
.slide {
    
  clear: both; /* Clears floating elements */
  width: 70%; /* Full width of the parent */
  height: 0px; /* Initially hidden */
  overflow: hidden; /* Prevents overflow content from showing */
  text-align: center; /* Centers text inside */
  transition: height 0.4s ease; /* Smooth transition on expand/collapse */
  background: #f0f0f0; /* Light background to differentiate from nav */
  border-top: 0 solid #ddd; /* Subtle border to separate sections */
  margin-top: 1px;
}

/* List items inside the slide section */
.slide li {
  padding: 2px; /* Padding for list items */
  color: #2d2f31; /* Text color matching the overall theme */
  border-bottom: 0 solid #ccc; /* Divider between list items */
  font-size: 1em; /* Consistent font size */
}

/* Hidden checkbox for toggling the slide */
#touch {
  position: absolute; /* Positioned out of sight */
  opacity: 0; /* Fully transparent */
  height: 0px; /* Zero height */
  z-index: -1; /* Behind other elements */
}

/* When checkbox is checked, expand the slide */
#touch:checked + .slide {
  height: 60px; /* Expanded height */
}

/* Responsive adjustments */
@media (max-width: 600px) {
  .nav {
    width: 200px; /* Narrower width on smaller screens */
    padding: 8px 10px; /* Adjust padding for smaller screens */
    box-shadow: none; /* Removes shadow for a cleaner mobile view */
  }

  .slide li {
    padding: 15px; /* Reduces padding for better fit */
  }
}

.renid {
     /* Enables flexbox layout */
    height: 30%;
    /* Adds padding around the element */
    border: none; /* Removes any border */
    border-radius: 4px; /* Slightly rounds the corners */
    border-bottom-left-radius: 15px;
    border-bottom-right-radius: 15px;
    margin-top: 0;
    padding-bottom: 10px;
    background-color: #1f1f1f; /* Sets a dark background color */
    box-shadow: 0px 4px 8px rgba(42, 42, 42, 0.6); /* Adds a subtle shadow effect */
}
.options-section {
    position: fixed; /* Fix the section at the bottom */
    bottom: 30px; /* Space from the bottom */
    left: 20px; /* Space from the left */
    display: flex; /* Aligns items in a row */
    flex-direction: column; /* Stack items vertically */
    gap: 15px; /* Space between the items */
    z-index: 1000; /* Ensure it stays on top */
}

.option-button {
    display: flex; /* Flex layout for icon and text */
    align-items: center; /* Center items vertically */
    background-color: #333; /* Dark background color */
    border: none; /* No border */
    border-radius: 8px; /* Rounded corners */
    padding: 4px 12px; /* Padding for the button */
    cursor: pointer; /* Pointer cursor on hover */
    color: white; /* White text color */
    gap: 10px; /* Space between icon and text */
    transition: background-color 0.3s; /* Smooth hover effect */
}

.option-button:hover {
    background-color: #444; /* Darker shade on hover */
}

.option-button svg {
    width: 20px; /* Icon size */
    height: 20px; /* Icon size */
    fill: white; /* White icon color */
}
.video-section {
    position: relative;
}

.video-controls {
    position: absolute;
      /* 10px above the bottom of the video */
    left: 210px;   /* 10px away from the right side */
    display: flex;
    gap: 20px;
    z-index: 10;   /* Ensure it appears above the video */
}

button {
    background-color: #1f1f1f; /* Semi-transparent background */
    border: none;
    border-radius: 10px;
    padding: 15px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

button:hover {
    background-color: rgba(0, 0, 0, 0.8); /* Darker background on hover */
}

button svg {
    fill: white;  /* Change SVG color */
    stroke: white;
    width: 24px;
    height: 24px;
}
/* Progress bar container */
.progress-container {
    position: relative;
    top: 5px;
    left: 0;
    right: 0;
    height: 30px;
    background-color: rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    overflow: hidden;
    margin: 10px 20px;
}

/* The actual progress bar that turns green as video plays */
#progressBar {
    height: 100%;
    background-color: #14adad;
    width: 0%;
    border-radius: 10px;
    transition: width 0.1s ease;
}
.render-button {
    position: absolute;
    top: 80px;
    border: none;
    border-radius: 10px;
    background-color: #4ade80; /* Dark background */
    color: white;
    border: none;
    padding: 20px 40px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: background-color 0.3s ease;
    
}
/* Adjust the layout for mobile devices */
@media only screen and (max-width: 768px) {
    body {
        width: 410px;
    }
}
.processing-green {
    content: 'Rendering';
    background-color: #35a25d; /* Dark Green */

}

.spinner {
  width: 48px;
  height: 48px;
  display: inline-block;
  position: relative;
  transform: rotate(45deg);
  z-index: 9999;
}

.spinner::before {
  content: '';
  box-sizing: border-box;
  width: 24px;
  height: 24px;
  position: absolute;
  left: 0;
  top: -24px;
  animation: spinnerAnim 4s ease infinite;
}

.spinner::after {
  content: '';
  box-sizing: border-box;
  position: absolute;
  left: 0;
  top: 0;
  width: 24px;
  height: 24px;
  background: rgba(255, 255, 255, 0.85);
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.15);
  animation: spinnerAnim2 2s ease infinite;
}

@keyframes spinnerAnim {
  0% {
    box-shadow: 0 24px rgba(255, 255, 255, 0), 24px 24px rgba(255, 255, 255, 0), 24px 48px rgba(255, 255, 255, 0), 0px 48px rgba(255, 255, 255, 0);
  }
  12% {
    box-shadow: 0 24px white, 24px 24px rgba(255, 255, 255, 0), 24px 48px rgba(255, 255, 255, 0), 0px 48px rgba(255, 255, 255, 0);
  }
  25% {
    box-shadow: 0 24px white, 24px 24px white, 24px 48px rgba(255, 255, 255, 0), 0px 48px rgba(255, 255, 255, 0);
  }
  37% {
    box-shadow: 0 24px white, 24px 24px white, 24px 48px white, 0px 48px rgba(255, 255, 255, 0);
  }
  50% {
    box-shadow: 0 24px white, 24px 24px white, 24px 48px white, 0px 48px white;
  }
  62% {
    box-shadow: 0 24px rgba(255, 255, 255, 0), 24px 24px white, 24px 48px white, 0px 48px white;
  }
  75% {
    box-shadow: 0 24px rgba(255, 255, 255, 0), 24px 24px rgba(255, 255, 255, 0), 24px 48px white, 0px 48px white;
  }
  87% {
    box-shadow: 0 24px rgba(255, 255, 255, 0), 24px 24px rgba(255, 255, 255, 0), 24px 48px rgba(255, 255, 255, 0), 0px 48px white;
  }
  100% {
    box-shadow: 0 24px rgba(255, 255, 255, 0), 24px 24px rgba(255, 255, 255, 0), 24px 48px rgba(255, 255, 255, 0), 0px 48px rgba(255, 255, 255, 0);
  }
}

@keyframes spinnerAnim2 {
  0% {
    transform: translate(0, 0) rotateX(0) rotateY(0);
  }
  25% {
    transform: translate(100%, 0) rotateX(0) rotateY(180deg);
  }
  50% {
    transform: translate(100%, 100%) rotateX(-180deg) rotateY(180deg);
  }
  75% {
    transform: translate(0, 100%) rotateX(-180deg) rotateY(360deg);
  }
  100% {
    transform: translate(0, 0) rotateX(0) rotateY(360deg);
  }
}

    </style>
</head>
<body>
    <header class="edit">
        <!-- Title of the header section -->
        <h2 class="editline">Ae edit section</h2>
      
        <!-- Container for the bottom buttons -->
        <div class="header-bottom">
            <button onclick="history.back()"class="header-button template-button"style="background-color: red;">
                <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 17h6m-3 3v-6M4.857 4h4.286c.473 0 .857.384.857.857v4.286a.857.857 0 0 1-.857.857H4.857A.857.857 0 0 1 4 9.143V4.857C4 4.384 4.384 4 4.857 4Zm10 0h4.286c.473 0 .857.384.857.857v4.286a.857.857 0 0 1-.857.857h-4.286A.857.857 0 0 1 14 9.143V4.857c0-.473.384-.857.857-.857Zm-10 10h4.286c.473 0 .857.384.857.857v4.286a.857.857 0 0 1-.857.857H4.857A.857.857 0 0 1 4 19.143v-4.286c0-.473.384-.857.857-.857Z"/>
                  </svg>
                  
                
            </button>
    
            <div onclick="attachRedirectToButton(Url)" class="header-button export-button" id="export-templete">
                <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 13V4M7 14H5a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-2m-1-5-4 5-4-5m9 8h.01"/>
                </svg>
            </div>
            
            
        </div>
    </header>
    <div class="renid">
    <nav>
        <label for="touch"><span>Template ID</span></label>               
    <input type="checkbox" id="touch">
    <ul class="slide">
        <li><a id="template-id-link"></a></li>  
    </ul>
    </nav> 
    
    <div class="editor-container">
    <div class="video-section" id="videoSection">
        <video id="videoPlayer" autoplay playsinline loop muted>
            <source src="your-video-url.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
</div>

        
        <div class="progress-container">
            <div id="progressBar"></div>
        </div>
    </div>
    
    
        

        <div class="options-section" id="optionsSection">
            
            <div class="video-controls">
                <!-- Pause/Resume Button -->
                <button id="pauseResumeButton">
                    <!-- Pause SVG Icon -->
                    <svg id="pauseResumeIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg>
                </button>
                
                <!-- Mute/Unmute Button -->
                <button id="muteUnmuteButton">
                    <!-- Mute SVG Icon -->
                    <svg id="muteUnmuteIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M9 9v6h4l5 5V4l-5 5H9zm11-1c0-2.35-.96-4.47-2.52-6.03L16.12 4.3C17.29 5.48 18 7.12 18 9h2zm-3.06 2.34-1.42-1.42C16.36 7.75 16 6.43 16 5h-2c0 1.95.79 3.71 2.06 5.06z"/>
                    </svg>

                      
                </button>
                <div id="renderButton" class="render-button">
                    <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                        <path fill-rule="evenodd" d="M9 7V2.221a2 2 0 0 0-.5.365L4.586 6.5a2 2 0 0 0-.365.5H9Zm2 0V2h7a2 2 0 0 1 2 2v9.293l-2-2a1 1 0 0 0-1.414 1.414l.293.293h-6.586a1 1 0 1 0 0 2h6.586l-.293.293A1 1 0 0 0 18 16.707l2-2V20a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9h5a2 2 0 0 0 2-2Z" clip-rule="evenodd"/>
                      </svg>
                      
                    Render
                </div>
            </div>
            <button class="option-button" id="costomzing"style="background-color:#1f1f1f">
                <h4>Pre-Render Settings</h4>
                <!-- Replace with your Text SVG code -->
                <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M5 13.17a3.001 3.001 0 0 0 0 5.66V20a1 1 0 1 0 2 0v-1.17a3.001 3.001 0 0 0 0-5.66V4a1 1 0 0 0-2 0v9.17ZM11 20v-9.17a3.001 3.001 0 0 1 0-5.66V4a1 1 0 1 1 2 0v1.17a3.001 3.001 0 0 1 0 5.66V20a1 1 0 1 1-2 0Zm6-1.17V20a1 1 0 1 0 2 0v-1.17a3.001 3.001 0 0 0 0-5.66V4a1 1 0 1 0-2 0v9.17a3.001 3.001 0 0 0 0 5.66Z"/>
                  </svg>
                  
                <!-- Render Button in HTML -->


            </button>
            

            <!-- Button with SVG for Image Option -->
            <button class="option-button" id="textOption">  
                <!-- Replace with your Image SVG code -->
                <svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <!-- Your Text Icon SVG Code -->
                    <path d="M4.266 5.792a1.5 1.5 0 0 1 1.5-1.5h12.468a1.5 1.5 0 0 1 1.5 1.5v1.85a.75.75 0 0 1-1.5 0v-1.35a.5.5 0 0 0-.5-.5H12.75v11.939a.5.5 0 0 0 .5.5h1.875a.75.75 0 0 1 0 1.5h-6.25a.75.75 0 1 1 0-1.5h1.875a.5.5 0 0 0 .5-.5V5.792H6.266a.5.5 0 0 0-.5.5V7.67a.75.75 0 1 1-1.5 0V5.792Z"></path>
                </svg>
                Text change
            </button>

            <!-- Button with SVG for Upload Option -->
            <button class="option-button" id="uploadOption">
                <!-- Replace with your Upload SVG code -->
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9 7C9 4.23858 11.2386 2 14 2C16.7614 2 19 4.23858 19 7V15C19 18.866 15.866 22 12 22C8.13401 22 5 18.866 5 15V9C5 8.44772 5.44772 8 6 8C6.55228 8 7 8.44772 7 9V15C7 17.7614 9.23858 20 12 20C14.7614 20 17 17.7614 17 15V7C17 5.34315 15.6569 4 14 4C12.3431 4 11 5.34315 11 7V15C11 15.5523 11.4477 16 12 16C12.5523 16 13 15.5523 13 15V9C13 8.44772 13.4477 8 14 8C14.5523 8 15 8.44772 15 9V15C15 16.6569 13.6569 18 12 18C10.3431 18 9 16.6569 9 15V7Z" fill="currentColor"></path></svg>
                <path fill-rule="evenodd" clip-rule="evenodd" d="M9 7C9 4.23858 11.2386 2 14 2C16.7614 2 19 4.23858 19 7V15C19 18.866 15.866 22 12 22C8.13401 22 5 18.866 5 15V9C5 8.44772 5.44772 8 6 8C6.55228 8 7 8.44772 7 9V15C7 17.7614 9.23858 20 12 20C14.7614 20 17 17.7614 17 15V7C17 5.34315 15.6569 4 14 4C12.3431 4 11 5.34315 11 7V15C11 15.5523 11.4477 16 12 16C12.5523 16 13 15.5523 13 15V9C13 8.44772 13.4477 8 14 8C14.5523 8 15 8.44772 15 9V15C15 16.6569 13.6569 18 12 18C10.3431 18 9 16.6569 9 15V7Z" fill="currentColor"></path>
             Frame change     
            </button>
        </div>
        

        <div class="action-section" id="actionSection" style="display: none;">
            <!-- This section will display when an option is clicked -->
            <input type="text" id="textInput" placeholder="Enter text" style="display: none;">
            <button class="upload-btn" id="confirmUpload" style="display: none;">Upload Image</button>
        </div>
        
    </div>
    <!-- Upload Popup -->
    <div class="upload-popup" id="uploadPopup">
        <div class="popup-content">
            <!-- Close button at the top-right -->
            <button class="close-popup" id="closePopup">&times;</button>
        
        <h2>change Frame</h2>
        <input type="file" id="imageUpload" accept="image/*" />
        
        <!-- Image Preview Area for Cropping -->
        <div class="image-preview">
            <img id="imagePreview" src="https://res.cloudinary.com/dkr5qwdjd/image/upload/v1727286620/gyjwxbntwv0ee4o8mwfg.jpg" alt="Image Preview" />
        </div>
        <div id="spinner" style="display: none;">Uploading...</div>

        <button id="cropImage">Blend</button>
    </div>
</div>

    

    <script>
// Simulate receiving the video URL from a webhook
let video_url = null;  // Initially, no video URL

// This function is called when the video URL is received from the webhook
function onWebhookReceive(url) {
    video_url = url;  // Set the video URL
    updateButtonState();
}

// Enable the button and change its appearance if the URL is available


// Open the video URL in a new tab when the button is clicked
function openVideoUrl() {
    if (video_url && video_url.trim() !== "") {
        window.open(video_url, '_blank');
    }
}

// Simulate receiving the video URL from the webhook after rendering
// Example: onWebhookReceive('https://example.com/rendered-video.mp4');


// Get video element and control buttons
const videoPlayer = document.getElementById('videoPlayer');
const pauseResumeButton = document.getElementById('pauseResumeButton');
const pauseResumeIcon = document.getElementById('pauseResumeIcon');
const muteUnmuteButton = document.getElementById('muteUnmuteButton');
const muteUnmuteIcon = document.getElementById('muteUnmuteIcon');

// Pause/Resume functionality with SVG icon
pauseResumeButton.addEventListener('click', () => {
    if (videoPlayer.paused) {
        videoPlayer.play();
        pauseResumeIcon.innerHTML = `
            <rect x="6" y="4" width="4" height="16"></rect>
            <rect x="14" y="4" width="4" height="16"></rect>`;
    } else {
        videoPlayer.pause();
        pauseResumeIcon.innerHTML = `
            <polygon points="5 3 19 12 5 21 5 3"></polygon>`;
    }
});
// Update the progress bar width as the video plays
videoPlayer.addEventListener('timeupdate', function() {
    const percentage = (videoPlayer.currentTime / videoPlayer.duration) * 100;
    progressBar.style.width = percentage + '%';
});

// Initialize state (optional but helpful)
document.addEventListener('DOMContentLoaded', function() {
    if (videoPlayer.paused) {
        playIcon.style.display = 'inline-block';
        pauseIcon.style.display = 'none';
    } else {
        playIcon.style.display = 'none';
        pauseIcon.style.display = 'inline-block';
    }
    
    if (videoPlayer.muted) {
        muteIcon.style.display = 'none';
        unmuteIcon.style.display = 'inline-block';
    } else {
        muteIcon.style.display = 'inline-block';
        unmuteIcon.style.display = 'none';
    }
});


// Mute/Unmute functionality with SVG icon
muteUnmuteButton.addEventListener('click', () => {
    if (videoPlayer.muted) {
        videoPlayer.muted = false;
        muteUnmuteIcon.innerHTML = `
            <path d="M9 9v6h4l5 5V4l-5 5H9zm11-1c0-2.35-.96-4.47-2.52-6.03L16.12 4.3C17.29 5.48 18 7.12 18 9h2zm-3.06 2.34-1.42-1.42C16.36 7.75 16 6.43 16 5h-2c0 1.95.79 3.71 2.06 5.06z"/>
       `;
    } else {
        videoPlayer.muted = true;
        muteUnmuteIcon.innerHTML = `
            <path d="M5.707 4.293a1 1 0 0 0-1.414 1.414l14 14a1 1 0 0 0 1.414-1.414l-.004-.005C21.57 16.498 22 13.938 22 12a9.972 9.972 0 0 0-2.929-7.071 1 1 0 1 0-1.414 1.414A7.972 7.972 0 0 1 20 12c0 1.752-.403 3.636-1.712 4.873l-1.433-1.433C17.616 14.37 18 13.107 18 12c0-1.678-.69-3.197-1.8-4.285a1 1 0 1 0-1.4 1.428A3.985 3.985 0 0 1 16 12c0 .606-.195 1.335-.59 1.996L13 11.586V6.135c0-1.696-1.978-2.622-3.28-1.536L7.698 6.284l-1.99-1.991ZM4 8h.586L13 16.414v1.451c0 1.696-1.978 2.622-3.28 1.536L5.638 16H4a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2Z"/>
        `;
    }
});


    
   document.addEventListener('DOMContentLoaded', function () {
    // Get the video URL from the query parameter
    const urlParams = new URLSearchParams(window.location.search);
    const videoUrl = urlParams.get('video_url');
    console.log(videoUrl);
    

    // Display the video in the video player
    const videoPlayer = document.getElementById('videoPlayer');
    videoPlayer.src = decodeURIComponent(videoUrl);

    // Extract crop size, render ID, and template ID from the video URL
    const fileName = videoUrl.split('/').pop();  // Get the file name
    const matchPattern = /_(\d+)of(\d+)andrenderid([a-zA-Z0-9-]+)_templeteid([a-zA-Z0-9-]+)\.mp4/;

    let cropWidth, cropHeight, renderId, templateId;

    const match = fileName.match(matchPattern);
    if (match) {
        cropWidth = parseInt(match[1]);  // Extract width (e.g., 1080)
        cropHeight = parseInt(match[2]); // Extract height (e.g., 1080)
        renderId = match[3];             // Extract render ID
        templateId = match[4];           // Extract template ID
        
        // Log extracted values to the console
        console.log(`Crop size: Width = ${cropWidth}, Height = ${cropHeight}`);
        console.log(`Render ID: ${renderId}`);
        console.log(`Template ID: ${templateId}`);
        document.getElementById("template-id-link").textContent = templateId;
    } else {
        console.log('Invalid file format or no crop size, render ID, and template ID found.');
        // Set default crop size if necessary
        cropWidth = 1280;
        cropHeight = 720;
    }

    const uploadOption = document.getElementById('uploadOption');
    const uploadPopup = document.getElementById('uploadPopup');
    const closePopup = document.getElementById('closePopup');
    const imageUpload = document.getElementById('imageUpload');
    const imagePreview = document.getElementById('imagePreview');
    const cropImage = document.getElementById('cropImage');
    
    let cropper;

    // When user clicks the Upload button, show the pop-up
    uploadOption.addEventListener('click', function () {
        uploadPopup.classList.add('active'); // Show the pop-up
    });

    // Close pop-up when clicking on the close button
    closePopup.addEventListener('click', function () {
        uploadPopup.classList.remove('active'); // Hide the pop-up
        if (cropper) {
            cropper.destroy(); // Remove cropper when pop-up is closed
        }
    });

    // Handle image selection
    imageUpload.addEventListener('change', function (e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function (e) {
                imagePreview.src = e.target.result;

                // Destroy old cropper instance if it exists
                if (cropper) {
                    cropper.destroy();
                }

                // Initialize Cropper.js with the extracted aspect ratio
                cropper = new Cropper(imagePreview, {
                    aspectRatio: cropWidth / cropHeight,  // Use the extracted crop size
                    viewMode: 1
                });
            };
            reader.readAsDataURL(file);
        }
    });

    // Handle cropping and uploading
    cropImage.addEventListener('click', async function () {
        if (cropper) {
            const canvas = cropper.getCroppedCanvas({
                width: cropWidth,  // Use the extracted width
                height: cropHeight // Use the extracted height
            });

            // Convert canvas to a Blob and send it to the server
            canvas.toBlob(async function (blob) {
                const newVideoUrl = await uploadImage(blob);
                if (newVideoUrl) {
                    
                    uploadPopup.classList.remove('active'); // Close the pop-up
                    // Send the templateId, renderId, and new video URL to the server
                    
                } else {
                    alert('Failed to upload image');
                }
            });
        }
    });

    let colorToggleInterval;

function toggleButtonColor(button) {
    // Start the color toggle interval
    colorToggleInterval = setInterval(() => {
        button.classList.toggle('processing-green'); // Toggle between green and dark green
    }, 500); // Toggle every 500ms
}

function stopButtonColorToggle() {
    clearInterval(colorToggleInterval); // Stop the color toggle
}
    // JavaScript code
document.getElementById("renderButton").addEventListener("click", async function() {
    
    try {
        const renderButton = this; 
        toggleButtonColor(renderButton);
        await submitRenderRequest(templateId, renderId, uploadi_mg);
        
        updateProgressBar(5); 
        console.log("Render request submitted successfully");
    } catch (error) {
        console.error("Error in rendering:", error);
        stopButtonColorToggle();
    }
});
    // Upload image function
    async function uploadImage(imageBlob) {
    const serverUrl = 'https://clothchangergraadioserver.onrender.com/uploadclodiver';
    const formData = new FormData();
    formData.append('file', imageBlob, 'cropped_image.png'); // Append cropped image

    // Get the spinner element
    const spinner = document.getElementById('spinner');
    
    // Show the spinner
    spinner.style.display = 'block';

    try {
        const response = await fetch(serverUrl, {
            method: 'POST',
            body: formData
        });
        const data = await response.json();
        
        // Hide the spinner after receiving a response
        spinner.style.display = 'none';

        if (data.uploadedimage) {
            uploadi_mg = data.uploadedimage;
            console.log('Uploaded Image URL:', uploadi_mg);
            return uploadi_mg;
        } else {
            console.error('No new video URL found in the response.');
            return null;
        }
    } catch (error) {
        // Hide the spinner in case of an error
        spinner.style.display = 'none';
        console.error('Error during fetch:', error);
        return null;
    }
}

function updateProgressBar(percentage) {
    progressBar.style.width = percentage + '%';
}    

async function submitRenderRequest(templateId, renderId, uploadi_mg) {
    const renderButton = this; 
    
    const serverUrl = 'https://weebhookplainlyrender.onrender.com/submit_render'; 
    const payload = {
        templateId: templateId,
        renderId: renderId,
        parameters: {
            changeimg: uploadi_mg  // Add other parameters if necessary
        }
    };
    try {
        const response = await fetch(serverUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload)
        });
        
        const data = await response.json();
        if (response.ok) {
            console.log('Render request submitted successfully:', data);// Play the rendered video
            const newViUrl = data.video_url;
            videoPlayer.src = newViUrl;
            videoPlayer.play();
            stopButtonColorToggle();
            renderButton.classList.remove('processing-green');
            attachRedirectToButton(newViUrl);
        } else {
            console.error('Failed to submit render request:', data.error || 'Unknown error');
            
        }
    } catch (error) {
        console.error('Error during render request submission:', error);
        
    }
}
    updateProgressBar(100); 
});
    const newViUrl = data.video_url;
    window.addEventListener('DOMContentLoaded', (event) => {
        // Select the button
        const exportButton = document.getElementById('export-templete');    // Check if the button exists in the DOM
        if (exportButton) {
            // Add click event listener to redirect when clicked
            exportButton.addEventListener('click', function() {
                window.location.href = url; // Redirect to the URL stored in newViUrl
            });
        } else {
            console.log('Button not found!');
        }
    });
// Function to attach redirection functionality to the button
function attachRedirectToButton(url) {
    const exportButton = document.getElementById('export-templete');

    // Add an event listener to redirect on click
    exportButton.addEventListener('click', () => {
        window.location.href = url; // Redirect to the video URL
    });
}

    </script>
</body>
</html>
